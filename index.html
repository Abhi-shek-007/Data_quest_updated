<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AI-Powered Rice Crop Yield Predictor with Smart Advisor</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <meta name="description" content="AI-powered rice crop yield prediction with intelligent farming advice and real-time agricultural guidance">
    <link rel="icon" type="image/x-icon" href="/favicon.ico">
</head>
<body>
    <!-- Rice Field Background Animation -->
    <div class="rice-field-background">
        <div class="rice-stalks">
            <div class="rice-stalk"></div>
            <div class="rice-stalk"></div>
            <div class="rice-stalk"></div>
            <div class="rice-stalk"></div>
            <div class="rice-stalk"></div>
            <div class="rice-stalk"></div>
            <div class="rice-stalk"></div>
            <div class="rice-stalk"></div>
        </div>
        <div class="floating-clouds">
            <div class="cloud cloud-1"></div>
            <div class="cloud cloud-2"></div>
            <div class="cloud cloud-3"></div>
        </div>
    </div>

    <!-- Header Section -->
    <header class="header">
        <div class="container">
            <div class="header-content">
                <div class="header-icon">
                    <i class="fas fa-seedling"></i>
                </div>
                <div class="header-text">
                    <h1>AI-Powered Rice Crop Yield Predictor</h1>
                    <p>Optimize your farming decisions with intelligent yield predictions and AI agricultural advisor</p>
                </div>
                <div class="header-actions">
                    <button onclick="scrollToChatbot()" class="btn btn--outline">
                        <i class="fas fa-robot"></i> AI Advisor
                    </button>
                </div>
            </div>
        </div>
    </header>

    <!-- Main Content -->
    <main class="main">
        <div class="container">
            <!-- Input Form Section -->
            <section class="form-section">
                <div class="card form-card">
                    <div class="card__header">
                        <h2><i class="fas fa-tractor"></i> Crop Information</h2>
                        <p>Enter your field details for accurate yield prediction and harvest timeline</p>
                    </div>
                    <div class="card__body">
                        <form id="cropForm" class="crop-form">
                            <div class="form-row">
                                <div class="form-group">
                                    <label class="form-label" for="farmerName">
                                        <i class="fas fa-user"></i> Farmer Name
                                    </label>
                                    <input type="text" id="farmerName" name="farmerName" class="form-control" required>
                                </div>
                                <div class="form-group">
                                    <label class="form-label" for="landArea">
                                        <i class="fas fa-map"></i> Land Area (hectares)
                                    </label>
                                    <input type="number" id="landArea" name="landArea" class="form-control" min="0.1" step="0.1" required>
                                </div>
                            </div>

                            <div class="form-row">
                                <div class="form-group">
                                    <label class="form-label" for="state">
                                        <i class="fas fa-flag"></i> State
                                    </label>
                                    <select id="state" name="state" class="form-control" required>
                                        <option value="">Select state</option>
                                        <option value="Andhra Pradesh">Andhra Pradesh</option>
                                        <option value="Bihar">Bihar</option>
                                        <option value="Chhattisgarh">Chhattisgarh</option>
                                        <option value="Gujarat">Gujarat</option>
                                        <option value="Haryana">Haryana</option>
                                        <option value="Karnataka">Karnataka</option>
                                        <option value="Kerala">Kerala</option>
                                        <option value="Madhya Pradesh">Madhya Pradesh</option>
                                        <option value="Maharashtra">Maharashtra</option>
                                        <option value="Odisha">Odisha</option>
                                        <option value="Punjab">Punjab</option>
                                        <option value="Rajasthan">Rajasthan</option>
                                        <option value="Tamil Nadu">Tamil Nadu</option>
                                        <option value="Telangana">Telangana</option>
                                        <option value="Uttar Pradesh">Uttar Pradesh</option>
                                        <option value="West Bengal">West Bengal</option>
                                    </select>
                                </div>
                                <div class="form-group">
                                    <label class="form-label" for="soilType">
                                        <i class="fas fa-mountain"></i> Soil Type
                                    </label>
                                    <select id="soilType" name="soilType" class="form-control" required>
                                        <option value="">Select soil type</option>
                                        <option value="Clay">Clay</option>
                                        <option value="Loam">Loam (Ideal)</option>
                                        <option value="Sandy">Sandy</option>
                                        <option value="Silt">Silt</option>
                                        <option value="Peat">Peat</option>
                                    </select>
                                </div>
                                <div class="form-group">
                                    <label class="form-label" for="terrainType">
                                        <i class="fas fa-chart-area"></i> Terrain Type
                                    </label>
                                    <select id="terrainType" name="terrainType" class="form-control" required>
                                        <option value="">Select terrain</option>
                                        <option value="Flat">Flat (Ideal)</option>
                                        <option value="Gentle Slope">Gentle Slope</option>
                                        <option value="Steep Slope">Steep Slope</option>
                                        <option value="Valley">Valley</option>
                                        <option value="Plateau">Plateau</option>
                                    </select>
                                </div>
                            </div>

                            <div class="form-row">
                                <div class="form-group">
                                    <label class="form-label" for="irrigationMethod">
                                        <i class="fas fa-tint"></i> Irrigation Method
                                    </label>
                                    <select id="irrigationMethod" name="irrigationMethod" class="form-control" required>
                                        <option value="">Select irrigation method</option>
                                        <option value="Flood">Flood</option>
                                        <option value="Drip">Drip (Ideal)</option>
                                        <option value="Sprinkler">Sprinkler</option>
                                        <option value="Rain-fed">Rain-fed</option>
                                        <option value="Furrow">Furrow</option>
                                    </select>
                                </div>
                                <div class="form-group">
                                    <label class="form-label" for="fertilizerType">
                                        <i class="fas fa-flask"></i> Fertilizer Type
                                    </label>
                                    <select id="fertilizerType" name="fertilizerType" class="form-control" required>
                                        <option value="">Select fertilizer</option>
                                        <option value="NPK">NPK (Ideal)</option>
                                        <option value="Urea">Urea</option>
                                        <option value="DAP">DAP</option>
                                        <option value="Organic">Organic</option>
                                        <option value="Compost">Compost</option>
                                        <option value="None">None</option>
                                    </select>
                                </div>
                            </div>

                            <div class="form-row">
                                <div class="form-group">
                                    <label class="form-label" for="fertilizerQuantity">
                                        <i class="fas fa-weight-hanging"></i> Fertilizer Quantity (kg/hectare)
                                        <span class="ideal-hint">Ideal: 135 kg/ha</span>
                                    </label>
                                    <input type="number" id="fertilizerQuantity" name="fertilizerQuantity" class="form-control" min="0" required>
                                </div>
                                <div class="form-group">
                                    <label class="form-label" for="previousCrop">
                                        <i class="fas fa-history"></i> Previous Crop
                                    </label>
                                    <select id="previousCrop" name="previousCrop" class="form-control" required>
                                        <option value="">Select previous crop</option>
                                        <option value="None">None</option>
                                        <option value="Rice">Rice</option>
                                        <option value="Wheat">Wheat</option>
                                        <option value="Sugarcane">Sugarcane</option>
                                        <option value="Cotton">Cotton</option>
                                        <option value="Vegetables">Vegetables (Ideal)</option>
                                    </select>
                                </div>
                            </div>

                            <div class="form-row">
                                <div class="form-group">
                                    <label class="form-label">
                                        <i class="fas fa-seed"></i> Seed Type
                                    </label>
                                    <div class="radio-group">
                                        <label class="radio-label">
                                            <input type="radio" name="seedType" value="Normal" required>
                                            <span class="radio-custom"></span>
                                            Normal
                                        </label>
                                        <label class="radio-label">
                                            <input type="radio" name="seedType" value="Hybrid" required>
                                            <span class="radio-custom"></span>
                                            Hybrid (Ideal)
                                        </label>
                                    </div>
                                </div>
                                <div class="form-group">
                                    <label class="form-label" for="plantingDate">
                                        <i class="fas fa-calendar"></i> Planting Date
                                    </label>
                                    <input type="date" id="plantingDate" name="plantingDate" class="form-control" required>
                                </div>
                            </div>

                            <div class="form-actions">
                                <button type="submit" class="btn btn--primary predict-btn">
                                    <span class="btn-content">
                                        <i class="fas fa-brain"></i>
                                        Predict Yield & Generate AI Advice
                                    </span>
                                    <span class="btn-loading hidden">
                                        <i class="fas fa-spinner fa-spin"></i>
                                        Analyzing...
                                    </span>
                                </button>
                            </div>
                        </form>
                    </div>
                </div>
            </section>

            <!-- Results Section -->
            <section class="results-section hidden" id="resultsSection">
                <!-- Harvest Timeline Section -->
                <div class="card timeline-card">
                    <div class="card__header">
                        <h3><i class="fas fa-clock"></i> Rice Growth Timeline & Harvest Schedule</h3>
                    </div>
                    <div class="card__body">
                        <div class="timeline-container" id="timelineContainer">
                            <!-- Timeline will be populated by JavaScript -->
                        </div>
                        <div class="harvest-info">
                            <div class="harvest-stat">
                                <span class="harvest-label">Days to Harvest:</span>
                                <span class="harvest-value" id="daysToHarvest">--</span>
                            </div>
                            <div class="harvest-stat">
                                <span class="harvest-label">Current Stage:</span>
                                <span class="harvest-value" id="currentStage">--</span>
                            </div>
                            <div class="harvest-stat">
                                <span class="harvest-label">Expected Harvest:</span>
                                <span class="harvest-value" id="expectedHarvest">--</span>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Yield Comparison Charts -->
                <div class="charts-grid">
                    <div class="card chart-card">
                        <div class="card__header">
                            <h3><i class="fas fa-chart-bar"></i> Yield Comparison</h3>
                        </div>
                        <div class="card__body">
                            <div class="chart-container" style="position: relative; height: 300px;">
                                <canvas id="yieldComparisonChart"></canvas>
                            </div>
                        </div>
                    </div>

                    <div class="card chart-card">
                        <div class="card__header">
                            <h3><i class="fas fa-tachometer-alt"></i> Efficiency Gauge</h3>
                        </div>
                        <div class="card__body">
                            <div class="chart-container" style="position: relative; height: 300px;">
                                <canvas id="efficiencyGaugeChart"></canvas>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Parameter Comparison Radar Chart -->
                <div class="card chart-card radar-chart-card">
                    <div class="card__header">
                        <h3><i class="fas fa-radar"></i> Conditions vs Ideal Comparison</h3>
                    </div>
                    <div class="card__body">
                        <div class="chart-container" style="position: relative; height: 400px;">
                            <canvas id="conditionsRadarChart"></canvas>
                        </div>
                    </div>
                </div>

                <!-- Yield & Income Results Grid -->
                <div class="results-grid">
                    <div class="card result-card yield-card">
                        <div class="card__body">
                            <div class="result-icon">
                                <i class="fas fa-chart-line"></i>
                            </div>
                            <div class="result-content">
                                <h3>Predicted Yield</h3>
                                <div class="result-value" id="predictedYield">0.0 tons/hectare</div>
                                <div class="confidence-level" id="confidenceLevel">Confidence: 85%</div>
                                <div class="efficiency-percent" id="efficiencyPercent">Efficiency: 0%</div>
                            </div>
                        </div>
                    </div>

                    <div class="card result-card income-card">
                        <div class="card__body">
                            <div class="result-icon">
                                <i class="fas fa-rupee-sign"></i>
                            </div>
                            <div class="result-content">
                                <h3>Expected Income</h3>
                                <div class="result-value" id="expectedIncome">‚Çπ0</div>
                                <div class="income-per-hectare" id="incomePerHectare">‚Çπ0 per hectare</div>
                                <div class="potential-income" id="potentialIncome">Potential: ‚Çπ0 (+0%)</div>
                            </div>
                        </div>
                    </div>

                    <div class="card result-card risk-card">
                        <div class="card__body">
                            <div class="result-icon">
                                <i class="fas fa-shield-alt"></i>
                            </div>
                            <div class="result-content">
                                <h3>Performance Gap</h3>
                                <div class="result-value" id="yieldGap">0.0 tons/ha</div>
                                <div class="gap-percentage" id="gapPercentage">Below ideal</div>
                                <div class="improvement-potential" id="improvementPotential">Improvement potential</div>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="card recommendations-card">
                    <div class="card__header">
                        <h3><i class="fas fa-lightbulb"></i> Smart Crop Improvement Plan</h3>
                    </div>
                    <div class="card__body">
                        <ul class="recommendations-bullets" id="recommendationsList">
                        </ul>
                    </div>
                </div>

                <div class="results-actions">
                    <button type="button" class="btn btn--secondary" onclick="exportResults()">
                        <i class="fas fa-download"></i> Export Report
                    </button>
                    <button type="button" class="btn btn--outline" onclick="startNewPrediction()">
                        <i class="fas fa-plus"></i> New Prediction
                    </button>
                    <button type="button" class="btn btn--primary" onclick="scrollToChatbot()">
                        <i class="fas fa-robot"></i> Ask AI Advisor
                    </button>
                </div>
            </section>

            <!-- AI Chatbot Section -->
            <section class="chat-section" id="chatSection">
                <div class="card chat-card">
                    <div class="card__header chat-header">
                        <div class="chat-title">
                            <h3><i class="fas fa-robot"></i> AI Agricultural Advisor</h3>
                            <p>Your intelligent farming assistant - Ask about crops, soil, irrigation, and more!</p>
                        </div>
                        <div class="chat-actions">
                            <button id="newChatBtn" class="btn btn--outline btn--sm">
                                <i class="fas fa-plus"></i> New Chat
                            </button>
                        </div>
                    </div>
                    <div class="card__body chat-body">
                        <div class="chat-container">
                            <div class="chat-messages" id="chatMessages">
                                <!-- Chat messages will be populated here -->
                            </div>
                            <div class="typing-indicator hidden" id="typingIndicator">
                                <div class="typing-dots">
                                    <div class="dot"></div>
                                    <div class="dot"></div>
                                    <div class="dot"></div>
                                </div>
                                <span>AI is thinking...</span>
                            </div>
                        </div>
                        <div class="chat-input-container">
                            <div class="chat-suggestions">
                                <button class="suggestion-btn" onclick="askSuggestion('What is the best irrigation method for rice?')">
                                    üíß Best irrigation for rice?
                                </button>
                                <button class="suggestion-btn" onclick="askSuggestion('How to improve soil fertility for better yield?')">
                                    üå± Improve soil fertility?
                                </button>
                                <button class="suggestion-btn" onclick="askSuggestion('When is the right time to harvest rice?')">
                                    ‚è∞ Rice harvest timing?
                                </button>
                                <button class="suggestion-btn" onclick="askSuggestion('How to prevent rice diseases?')">
                                    ü¶† Prevent rice diseases?
                                </button>
                            </div>
                            <div class="chat-input-row">
                                <textarea 
                                    id="chatInput" 
                                    class="chat-input" 
                                    placeholder="Ask me about farming, crops, soil management, irrigation, or any agricultural question..."
                                    rows="2"></textarea>
                                <button id="sendChatBtn" class="btn btn--primary chat-send-btn">
                                    <i class="fas fa-paper-plane"></i>
                                </button>
                            </div>
                            <div class="chat-info">
                                <small><i class="fas fa-info-circle"></i> This AI advisor specializes in agricultural guidance. Ask questions about farming, crops, and agricultural best practices.</small>
                            </div>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Historical Data Section -->
            <section class="historical-section">
                <div class="card historical-card">
                    <div class="card__header">
                        <h2><i class="fas fa-history"></i> Historical Records</h2>
                        <div class="empty-state" id="emptyState">
                            <p>No records yet. Submit your first prediction to start tracking your crops!</p>
                        </div>
                        <div class="table-controls hidden" id="tableControls">
                            <input type="text" id="searchInput" placeholder="Search records..." class="form-control search-input">
                            <select id="sortSelect" class="form-control sort-select">
                                <option value="date">Sort by Date</option>
                                <option value="farmer_name">Sort by Farmer</option>
                                <option value="actual_yield">Sort by Yield</option>
                                <option value="income">Sort by Income</option>
                            </select>
                        </div>
                    </div>
                    <div class="card__body">
                        <div class="table-container hidden" id="tableContainer">
                            <table class="historical-records-table" id="historicalTable">
                                <thead>
                                    <tr>
                                        <th>Date</th>
                                        <th>Farmer</th>
                                        <th>Area (ha)</th>
                                        <th>Soil Type</th>
                                        <th>Irrigation</th>
                                        <th>Fertilizer</th>
                                        <th>Yield (t/ha)</th>
                                        <th>Efficiency (%)</th>
                                        <th>Income (‚Çπ)</th>
                                    </tr>
                                </thead>
                                <tbody id="historicalTableBody">
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </section>
        </div>
    </main>

    <!-- Footer -->
    <footer class="footer">
        <div class="container">
            <div class="footer-content">
                <div class="footer-section">
                    <h4>AI-Powered Rice Predictor</h4>
                    <p>Intelligent farming solutions for better crop yields</p>
                </div>
                <div class="footer-section">
                    <h4>Features</h4>
                    <ul>
                        <li>Yield Prediction</li>
                        <li>AI Agricultural Advisor</li>
                        <li>Growth Timeline</li>
                        <li>Optimization Roadmap</li>
                    </ul>
                </div>
                <div class="footer-section">
                    <h4>Support</h4>
                    <p>For technical support or questions about agricultural practices, use our AI advisor above.</p>
                </div>
            </div>
            <div class="footer-bottom">
                <p>&copy; 2024 AI-Powered Rice Crop Predictor. Built with advanced machine learning and agricultural expertise.</p>
            </div>
        </div>
    </footer>

    <script src="{{ url_for('static', filename='js/app.js') }}"></script>
    <script>
        // Helper function for chat suggestions
        function askSuggestion(question) {
            document.getElementById('chatInput').value = question;
            sendChatMessage();
        }

        // Scroll to chatbot function
        function scrollToChatbot() {
            document.getElementById('chatSection').scrollIntoView({ behavior: 'smooth' });
            setTimeout(() => {
                document.getElementById('chatInput').focus();
            }, 500);
        }
    </script>
</body>
</html>